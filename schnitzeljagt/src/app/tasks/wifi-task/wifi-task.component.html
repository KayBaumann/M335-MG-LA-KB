<div class="task-wrapper">
  <ng-container *ngIf="!initialLoading; else loadingState">

    <!-- WIFI DISPLAY -->
    <div class="wifi-card">
      <div class="center">
        <div class="icon-circle">
          <ion-icon
            name="wifi"
            class="wifi-icon"
            [class.connected]="isWifiConnected"
            [class.disconnected]="!isWifiConnected">
          </ion-icon>
        </div>

        <p class="subtitle">
          {{ isWifiConnected ? 'WLAN verbunden' : 'WLAN getrennt' }}
        </p>
      </div>
    </div>

    <!-- STATUS -->
    <div class="status-card">
      <div class="status-row">
        <span class="label">WLAN Status</span>
        <div class="status-right">
          <span class="dot" [class.dot-on]="isWifiConnected"></span>
          <span class="status-text" [class.status-on]="isWifiConnected">
            {{ isWifiConnected ? 'Verbunden' : 'Getrennt' }}
          </span>
        </div>
      </div>

      <div class="status-row">
        <span class="label">Einmal verbunden</span>
        <span class="value">{{ wasConnected ? 'Ja' : 'Nein' }}</span>
      </div>

      <div class="status-row">
        <span class="label">Einmal getrennt</span>
        <span class="value">{{ wasDisconnected ? 'Ja' : 'Nein' }}</span>
      </div>
    </div>

    <!-- CONTROLS -->
    <div class="controls">
      <ion-button
        expand="block"
        class="primary-btn"
        [disabled]="checking || completed"
        (click)="checkWifiStatus()">

        <ng-container *ngIf="!checking; else loading">
          <ion-icon slot="start" name="wifi"></ion-icon>
          Status prüfen
        </ng-container>

        <ng-template #loading>
          <ion-spinner name="crescent" class="spinner"></ion-spinner>
          Prüfe…
        </ng-template>
      </ion-button>

      <div class="done" *ngIf="completed">
        <ion-icon name="checkmark-circle" class="done-icon"></ion-icon>
        <span>Aufgabe abgeschlossen</span>
      </div>
    </div>

  </ng-container>

  <ng-template #loadingState>
    <div class="loading-screen">
      <ion-spinner name="crescent" class="initial-spinner"></ion-spinner>
      <p class="loading-text">WLAN-Status wird geprüft…</p>
    </div>
  </ng-template>
</div>
